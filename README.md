# RBM Agent: Reversible Free-Energy Minimization AI

[![MIT License](https://img.shields.io/badge/license-MIT-green.svg)](LICENSE)

> –ò—Å—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π PoC –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–∑–Ω–∞–Ω–∏—è:  
> –æ–±—Ä–∞—Ç–∏–º—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è, –ø–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–∞—è –ø–∞–º—è—Ç—å, —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å,  
> –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è free energy. –°–æ–≤–º–µ—â–∞–µ–º –∏–¥–µ–∏ Landauer/Bennett, Friston, Boltzmann, RevNet.

---

## üöÄ –ö–æ–Ω—Ü–µ–ø—Ü–∏—è

–°–æ–≤—Ä–µ–º–µ–Ω–Ω—ã–µ –Ω–µ–π—Ä–æ—Å–µ—Ç–µ–≤—ã–µ –ò–ò —Å—Ç–∏—Ä–∞—é—Ç –¥–µ—Ç–∞–ª–∏ –æ–ø—ã—Ç–∞ –∏ —Ç—Ä–∞—Ç—è—Ç —ç–Ω–µ—Ä–≥–∏—é –Ω–∞ –ø–µ—Ä–µ–ø–∏—Å—ã–≤–∞–Ω–∏–µ –≤–Ω—É—Ç—Ä–µ–Ω–Ω–∏—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏–π.  
–í —ç—Ç–æ–º –ø—Ä–æ–µ–∫—Ç–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≥–∏–ø–æ—Ç–µ–∑–∞: **–∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–∑–Ω–∞–Ω–∏–µ** –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:

- **–û–±—Ä–∞—Ç–∏–º—ã–º –ø–æ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º** (Reversible Computing, Landauer/Bennett)
- **–ü–µ—Ä–º–∞–Ω–µ–Ω—Ç–Ω–æ –Ω–∞–∫–∞–ø–ª–∏–≤–∞—é—â–∏–º —Å–∏–≥–Ω–∞–ª—ã** (–ø–∞–º—è—Ç—å –Ω–µ —Å—Ç–∏—Ä–∞–µ—Ç—Å—è)
- **–ú–∏–Ω–∏–º–∏–∑–∏—Ä—É—é—â–∏–º –≤–Ω—É—Ç—Ä–µ–Ω–Ω—é—é —ç–Ω–µ—Ä–≥–∏—é** (Free-Energy Principle, Friston/Boltzmann)

–†–µ–∞–ª–∏–∑–∞—Ü–∏—è:  
- RevNet (ResNet18 –±–µ–∑ fc, –æ–±—Ä–∞—Ç–∏–º–∞—è —ç–∫—Å—Ç—Ä–∞–∫—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤)
- Restricted Boltzmann Machine (RBM, –æ—Ü–µ–Ω–∫–∞ free energy)
- –ö–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –ø–∞–º—è—Ç–∏ (RingBuffer, —Ö—Ä–∞–Ω–∏—Ç –æ–ø—ã—Ç –±–µ–∑ —É–¥–∞–ª–µ–Ω–∏—è)
- –ú–∏–Ω–∏–º–∞–ª–∏—Å—Ç–∏—á–Ω–∞—è —Å—Ä–µ–¥–∞ GridWorld –¥–ª—è —Ç–µ—Å—Ç–∞ –ø–æ–≤–µ–¥–µ–Ω–∏—è –∞–≥–µ–Ω—Ç–∞

---

## üß© –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞

```plantuml
@startuml
actor "–û–∫—Ä—É–∂–µ–Ω–∏–µ" as Env
rectangle "–°–µ–Ω—Å–æ—Ä–Ω—ã–π –∫–æ–¥–µ—Ä\n(RevNet-18)" as SE
rectangle "–†–µ–≤–µ—Ä—Å–∏–≤–Ω–æ–µ —è–¥—Ä–æ\n(RBM, Free-Energy)" as RI
database "–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø–∞–º—è—Ç—å\n(RingBuffer)" as PM
rectangle "–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π\n(Policy/Critic)" as AG

Env -> SE : —Å–µ–Ω—Å–æ—Ä–Ω—ã–µ —Å—Ç–∏–º—É–ª—ã
SE -> RI : –ø—Ä–∏–∑–Ω–∞–∫–∏
RI -> PM : –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–∞–º—è—Ç–∏
PM -> RI : –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø—Ä–æ—à–ª–æ–≥–æ –æ–ø—ã—Ç–∞
RI -> AG : –ø—Ä–∏–Ω—è—Ç–∏–µ —Ä–µ—à–µ–Ω–∏–π (policy)
AG -> Env : –≤–æ–∑–¥–µ–π—Å—Ç–≤–∏–µ –Ω–∞ —Å—Ä–µ–¥—É
@enduml
````

* **–û–∫—Ä—É–∂–µ–Ω–∏–µ (Env):** –ø—Ä–æ—Å—Ç–∞—è grid-world —Å —à—É–º–æ–º, reward = +1 –∑–∞ —Ü–µ–ª—å, -0.01 –∑–∞ —à–∞–≥.
* **–°–µ–Ω—Å–æ—Ä–Ω—ã–π –∫–æ–¥–µ—Ä (RevNet):** –ø—Ä–µ–æ–±—Ä–∞–∑—É–µ—Ç –Ω–∞–±–ª—é–¥–µ–Ω–∏–µ –≤ –ø—Ä–∏–∑–Ω–∞–∫–∏.
* **–†–µ–≤–µ—Ä—Å–∏–≤–Ω–æ–µ —è–¥—Ä–æ (RBM):** –æ—Ü–µ–Ω–∏–≤–∞–µ—Ç free energy, —É—á–∏—Ç—Å—è –æ–ø–∏—Å—ã–≤–∞—Ç—å —Å–æ—Å—Ç–æ—è–Ω–∏—è.
* **–ü–æ—Å—Ç–æ—è–Ω–Ω–∞—è –ø–∞–º—è—Ç—å (RingBuffer):** —Ö—Ä–∞–Ω–∏—Ç –≤—Å–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –¥–ª—è –æ–±—É—á–µ–Ω–∏—è, –Ω–∏—á–µ–≥–æ –Ω–µ –∑–∞–±—ã–≤–∞–µ—Ç—Å—è.
* **–ì–µ–Ω–µ—Ä–∞—Ç–æ—Ä –¥–µ–π—Å—Ç–≤–∏–π (Agent):** baseline ‚Äî —Å–ª—É—á–∞–π–Ω—ã–π, –Ω–æ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ ‚àáF/policy –≥–æ—Ç–æ–≤–∞.

---

## üì¶ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

1. **–ö–ª–æ–Ω–∏—Ä—É–π—Ç–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π –∏ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**

   ```bash
   git clone git@github.com:vsradkevich/rbm_agent.git
   cd rbm_agent
   python3 -m venv .venv && source .venv/bin/activate
   pip install -r requirements.txt
   ```

2. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –æ–±—É—á–µ–Ω–∏–µ –∞–≥–µ–Ω—Ç–∞**

   ```bash
   python src/train.py
   ```

   * –ê–≥–µ–Ω—Ç –±—É–¥–µ—Ç —É—á–∏—Ç—å—Å—è 30 —ç–ø–æ—Ö –≤ —Å—Ä–µ–¥–µ GridWorld (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 8x8).
   * –ú–µ—Ç—Ä–∏–∫–∏ (`rewards_log`, `free_energy_log`) –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å –∏ –¥–æ—Å—Ç—É–ø–Ω—ã –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞.

---

## üìà –ü—Ä–∏–º–µ—Ä –≤—ã–≤–æ–¥–∞

```
–≠–ø–æ—Ö–∞ 1/30 | –°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞: -0.640 | –°—Ä. free energy: -22.0851
–≠–ø–æ—Ö–∞ 18/30 | –°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞: 1.000 | –°—Ä. free energy: -34.2501
...
```

* **–°—É–º–º–∞—Ä–Ω–∞—è –Ω–∞–≥—Ä–∞–¥–∞** –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∫–∞–∫ —á–∞—Å—Ç–æ –∞–≥–µ–Ω—Ç –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Ü–µ–ª–∏.
* **Free energy** —É–±—ã–≤–∞–µ—Ç ‚Äî RBM —É—á–∏—Ç—Å—è "—É–≤–µ—Ä–µ–Ω–Ω–µ–µ" –æ–ø–∏—Å—ã–≤–∞—Ç—å —Å—Ä–µ–¥—É.

---

## üß† –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è –ø–æ –∏–¥–µ–µ

**–í —á—ë–º –æ—Ç–ª–∏—á–∏–µ –æ—Ç –∫–ª–∞—Å—Å–∏—á–µ—Å–∫–∏—Ö RL/AI:**

* **–î–∞–Ω–Ω—ã–µ –Ω–µ —Å—Ç–∏—Ä–∞—é—Ç—Å—è** ‚Äî –æ–ø—ã—Ç —Ö—Ä–∞–Ω–∏—Ç—Å—è, –ø–∞–º—è—Ç—å –Ω–∏–∫–æ–≥–¥–∞ –Ω–µ –æ—á–∏—â–∞–µ—Ç—Å—è (permanent memory).
* **–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è free energy** ‚Äî –Ω–µ –ø—Ä–æ—Å—Ç–æ ‚Äú–Ω–∞–≥—Ä–∞–¥–Ω–∞—è‚Äù –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è, –∞ –≥–∞—Ä–º–æ–Ω–∏–∑–∞—Ü–∏—è —Å –º–∏—Ä–æ–º (–º–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –Ω–µ–æ–ø—Ä–µ–¥–µ–ª—ë–Ω–Ω–æ—Å—Ç–∏).
* **–û–±—Ä–∞—Ç–∏–º–æ—Å—Ç—å** ‚Äî –≤–æ–∑–º–æ–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ª—é–±–æ–π –ø—Ä–æ—à–ª—ã–π —à–∞–≥ (—Ä–µ–≤–µ—Ä—Å–∏–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞, Landauer/Bennett).

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –∏–¥–µ–π:**

* **Landauer, Bennett:** —Ä–µ–≤–µ—Ä—Å–∏–≤–Ω—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –¥–ª—è –º–∏–Ω–∏–º–∏–∑–∞—Ü–∏–∏ —Ç–µ–ø–ª–æ–≤—ã—Ö –ø–æ—Ç–µ—Ä—å.
* **Friston FEP:** –º–æ–∑–≥ –º–∏–Ω–∏–º–∏–∑–∏—Ä—É–µ—Ç free energy, –∞–≥–µ–Ω—Ç —É—á–∏—Ç—Å—è –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞—Ç—å –º–∏—Ä —Å –Ω–∞–∏–º–µ–Ω—å—à–µ–π –Ω–µ–æ–∂–∏–¥–∞–Ω–Ω–æ—Å—Ç—å—é.
* **RBM (Hinton):** —ç–Ω–µ—Ä–≥–µ—Ç–∏—á–µ—Å–∫–∞—è –º–æ–¥–µ–ª—å –¥–ª—è –æ—Ü–µ–Ω–∫–∏ —Å–æ—Å—Ç–æ—è–Ω–∏—è.
* **RevNet/ResNet:** —É—Å—Ç–æ–π—á–∏–≤–æ–µ –∏–∑–≤–ª–µ—á–µ–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤.

---

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
rbm_agent/
‚îÇ
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ agent.py         # –ê–≥–µ–Ω—Ç: RevNet + RBM + Critic + policy
‚îÇ   ‚îú‚îÄ‚îÄ buffer.py        # –ö–æ–ª—å—Ü–µ–≤–æ–π –±—É—Ñ–µ—Ä –ø–∞–º—è—Ç–∏
‚îÇ   ‚îú‚îÄ‚îÄ env.py           # –°—Ä–µ–¥–∞ GridWorld
‚îÇ   ‚îú‚îÄ‚îÄ inference.py     # (–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ) –ò–Ω—Ñ–µ—Ä–µ–Ω—Å/–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è
‚îÇ   ‚îú‚îÄ‚îÄ logger.py        # CSV-–ª–æ–≥–≥–µ—Ä –º–µ—Ç—Ä–∏–∫
‚îÇ   ‚îú‚îÄ‚îÄ model/
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ compressor.py  # (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) –∫–æ–º–ø—Ä–µ—Å—Å–∏—è –ø–∞–º—è—Ç–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ critic.py      # –ö—Ä–∏—Ç–∏–∫ (–≥—Ä–∞–¥–∏–µ–Ω—Ç free energy)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ rbm.py         # –û–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω–∞—è –º–∞—à–∏–Ω–∞ –ë–æ–ª—å—Ü–º–∞–Ω–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ revnet.py      # RevNet (ResNet18 –±–µ–∑ fc)
‚îÇ   ‚îî‚îÄ‚îÄ train.py         # –ì–ª–∞–≤–Ω—ã–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ—á–Ω—ã–π —Ü–∏–∫–ª PoC
‚îÇ
‚îú‚îÄ‚îÄ requirements.txt     # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ configs/             # (–∫–æ–Ω—Ñ–∏–≥–∏ –∏ –ø—Ä–µ—Å–µ—Ç—ã)
‚îî‚îÄ‚îÄ logs/                # (–º–µ—Ç—Ä–∏–∫–∏ –∏ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã)
```

---

## üìö –õ–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞ –∏ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

* Landauer, R. (1961). *Irreversibility and heat generation in the computing process*.
* Bennett, C.H. (1973). *Logical Reversibility of Computation*.
* Friston, K. (2010). *The free-energy principle: a unified brain theory?*
* Hinton, G. (2002). *Training products of experts by minimizing contrastive divergence*.

---

## üõ† Roadmap (–ø–ª–∞–Ω—ã —Ä–∞–∑–≤–∏—Ç–∏—è)

* [ ] –í–Ω–µ–¥—Ä–∏—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –Ω–∞ –æ—Å–Ω–æ–≤–µ ‚àáF (–≥—Ä–∞–¥–∏–µ–Ω—Ç free energy)
* [ ] –î–æ–±–∞–≤–∏—Ç—å –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—é —Ç—Ä–∞–µ–∫—Ç–æ—Ä–∏–π –∏ –∞–Ω–∞–ª–∏–∑–∞ –ø–∞–º—è—Ç–∏
* [ ] –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å RBM –∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å –Ω–∞ —Å–ª–æ–∂–Ω—ã—Ö —Å—Ä–µ–¥–∞—Ö (Atari, Procgen –∏ –¥—Ä.)
* [ ] –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º—É–ª—å—Ç–∏–º–æ–¥–∞–ª—å–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (–∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è, –∑–≤—É–∫, —Ç–µ–∫—Å—Ç)
* [ ] –°—Ç–∞—Ç—å–∏ –Ω–∞ Habr/Medium –æ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞—Ö

---

## ü§ù –ê–≤—Ç–æ—Ä—ã –∏ –∫–æ–Ω—Ç–∞–∫—Ç—ã

* –ê–≤—Ç–æ—Ä: [–í.–°. –†–∞–¥–∫–µ–≤–∏—á](https://github.com/vsradkevich)
* Telegram: [@vsradkevich](https://t.me/vsradkevich)
* –û–±—Å—É–∂–¥–µ–Ω–∏–µ ‚Äî —á–µ—Ä–µ–∑ [Issues](https://github.com/vsradkevich/rbm_agent/issues), Pull Requests –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤—É—é—Ç—Å—è!

---

## ‚öñÔ∏è –õ–∏—Ü–µ–Ω–∑–∏—è

[MIT License](LICENSE) ‚Äî —Å–≤–æ–±–æ–¥–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –¥–ª—è –Ω–∞—É–∫–∏, –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–π –∏ —Ñ–æ—Ä–∫–æ–≤.

---

> –ü—Ä–æ–µ–∫—Ç –æ—Ç–∫—Ä—ã—Ç –∫ —Ä–∞–∑–≤–∏—Ç–∏—é!
> –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–π—Å—è, –µ—Å–ª–∏ –∏–Ω—Ç–µ—Ä–µ—Å—É–µ—à—å—Å—è —Ä–µ–≤–µ—Ä—Å–∏–≤–Ω—ã–º–∏ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è–º–∏, –∏—Å–∫—É—Å—Å—Ç–≤–µ–Ω–Ω—ã–º —Å–æ–∑–Ω–∞–Ω–∏–µ–º –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞–º–∏ —Å–ª–µ–¥—É—é—â–µ–≥–æ –ø–æ–∫–æ–ª–µ–Ω–∏—è.
